<a href="https://github.com/4training/app4training/actions"><img src="https://github.com/4training/app4training/actions/workflows/main.yaml/badge.svg" alt="Tests Status"></a>
<a href="https://codecov.io/gh/4training/app4training"><img src="https://codecov.io/gh/4training/app4training/branch/main/graph/badge.svg" alt="Code Coverage (codecov)"></a>
# app4training
This app is an offline version of the website [4training.net](www.4training.net) written in dart/flutter.

Both, the app and the website are projects by [holydevelopers.net](https://holydevelopers.net/).

## Architecture
* For navigation we use the Navigator with named routes ("Navigator 1.0", no routing package). See the folder [lib/routes/](lib/routes), especially the [overview of the route names](lib/routes/routes.dart).
* For viewing a page, we use route names that are the same as on the [4training.net](https://www.4training.net) website: `/view/PageName/languageCode`, e.g. `/view/Dealing_with_Money/de` for viewing https://www.4training.net/Dealing_with_Money/de
* For state management we use [Riverpod](https://pub.dev/packages/riverpod) (version 2 but without using code generation)
* Internationalization via the [standard flutter internationalization approach](https://docs.flutter.dev/ui/accessibility-and-localization/internationalization)
* Widgets are in the [lib/widgets](lib/widgets) folder

### Content: synchronized from a git repository
* The content comes as HTML and is rendered via the [flutter_html](https://pub.dev/packages/flutter_html) package
* The app works offline and displays only content that has been downloaded to the device. For each language we have a repository that is hosted on github. The location is `https://github.com/4training/html-languageCode`, for English it is https://github.com/4training/html-en.
* When the user decides to download a language, the contents of the corresponding repository are fetched with the [download_assets](https://pub.dev/packages/download_assets) package and stored on a folder on the device.
* The repository contains HTML files for each page, images and a JSON with the structure. It is generated by the `ResourcesBot` of our [pywikitools](https://github.com/4training/pywikitools) repository (see [ExportHTML](https://github.com/4training/pywikitools/blob/main/pywikitools/resourcesbot/export_html.py) and [ExportRepository](https://github.com/4training/pywikitools/blob/main/pywikitools/resourcesbot/export_repository.py))

## License
Jesus says in Matthew 10:8, “Freely you have received; freely give.”
We follow His example and believe His principles are well expressed in the developer world through free and open-source software.
That's why we want you to have the ["four freedoms"](https://fsfe.org/freesoftware/) to freely use, study, share and improve this software.
We only require you to release any derived work under the same conditions (you're not allowed to take this code, build upon it and make the result proprietary):

[GNU Affero General Public License v3.0](LICENSE) with [Apple app store exception](COPYING.iOS)

The AGPL is essentially the same as the GPL with one additional paragraph allowing users who interact with the software over a network to receive the source for that program.
This is relevant for any web application where the way of software distribution is different than what was normal back when the GNU Public License was created.
The GPL wasn't aware of this form of distribution which is now so common. The AGPL fixes this "web services loophole".

Thanks to the people from the Nextcloud iOS app to [find and explain a solution](https://nextcloud.com/it/blog/nextcloud-ios-app-open-sourced/) to the restrictive policies of the Apple App Store which are not fully compatible with the GNU Public licenses.

## Testing and ensuring good code quality
For formatting code, we follow the dart guidelines by using the standard [dart format](https://dart.dev/tools/dart-format) tool. For linting we use [dart analyze](https://dart.dev/tools/dart-analyze) together with [riverpod lint](https://pub.dev/packages/riverpod_lint). Finally we have a test suite and upload coverage data to [codecov.io](https://codecov.io) - you can see the results in the codecov badge at the top here on the repo page. All that is run via Github Actions on any push or pull request (see [our Github Workflow](.github/workflows/main.yaml))

Before committing, please run the following commands and make sure they don't show any issues so that our tests will pass:
* `dart format .`
* `dart analyze`
* `dart run custom_lint`
* `flutter test`

## Contributing
By contributing you release your contributed code under the licensing terms explained above. Thank you!

## Roadmap
* **0.7**: Go to Google Play Store
* **0.8**: Provide PDF files as well for all worksheets
* **0.9**: Enable automatic updates (half-way implemented already but currently not operational - waiting for backend development to catch up)
* **1.0**: We're solid now and excited about the future

We plan to release an iOS version sometime in 2024.